<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Familydog_home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #e67e22; --bg: #fdfaf7; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 80px; }
        header { background: white; padding: 20px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .logo { max-width: 120px; margin-bottom: 10px; }
        .container { padding: 15px; max-width: 500px; margin: auto; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        h2 { color: var(--primary); font-size: 18px; margin-top: 0; display: flex; align-items: center; gap: 8px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; }
        .btn-wa { background: #25D366; margin-top: 10px; }
        .info-famiglia { font-style: italic; font-size: 14px; color: #555; line-height: 1.4; }
        nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; padding: 10px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        nav div { text-align: center; font-size: 12px; color: #999; flex: 1; cursor: pointer; }
        nav div i { font-size: 20px; display: block; }
        nav div.active { color: var(--primary); }
        .hidden { display: none; }
        .box-calendario { background: #fff9f0; border: 1px solid #ffe0b2; padding: 10px; border-radius: 8px; margin-top: 10px; }
    </style>
</head>
<body>

<header>
    <img src="logo.png" alt="Familydog Logo" class="logo">
    <h1 style="margin:0; font-size: 20px;">Familydog_home</h1>
</header>

<div class="container">
    
    <div id="section-login" class="card">
        <h2>Benvenuti in Famiglia</h2>
        <p class="info-famiglia">Siamo Davide e Maria, insieme alla piccola Giorgia di 5 anni accogliamo il tuo cane con tutto l'amore di una vera famiglia.</p>
        <input type="text" id="reg-nome" placeholder="Tuo Nome e Cognome">
        <input type="text" id="reg-cane" placeholder="Nome del Cane">
        <input type="text" id="reg-razza" placeholder="Razza">
        <select id="reg-sesso">
            <option value="">Sesso del cane</option>
            <option value="Maschio">Maschio</option>
            <option value="Femmina">Femmina</option>
        </select>
        <select id="reg-st">
            <option value="">Sterilizzato / Castrato?</option>
            <option value="Sì">Sì</option>
            <option value="No">No</option>
        </select>
        <textarea id="reg-note" placeholder="Note speciali o allergie..."></textarea>
        <button onclick="registra()">Registrati ed Entra</button>
    </div>

    <div id="section-home" class="hidden">
        <div class="card">
            <h2><i class="fa-solid fa-calendar-day"></i> Le mie Prenotazioni</h2>
            <div id="dati-cane-box" style="font-size: 14px; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;"></div>
            <div class="box-calendario">
                <strong>Stato Appuntamenti:</strong>
                <div id="status-messaggio" style="margin-top:5px; color: #e67e22;">Caricamento...</div>
            </div>
        </div>
        
        <div class="card">
            <h2>Contatti</h2>
            <button onclick="window.open('https://www.instagram.com/familydog_home', '_blank')" style="background: #E1306C;"><i class="fa-brands fa-instagram"></i> Instagram</button>
            <button class="btn-wa" onclick="richiediIncontro()"><i class="fa-brands fa-whatsapp"></i> Richiedi Incontro</button>
        </div>
    </div>

    <div id="section-metodo" class="hidden">
        <div class="card">
            <h2><i class="fa-solid fa-house-chimney"></i> Il nostro Cuore</h2>
            <p class="info-famiglia">Da noi il tuo cane vive in casa con noi e Giorgia. Abbiamo due giardini sicuri e tanto tempo da dedicare alle coccole.</p>
            <p style="font-size: 13px;"><i>* Portare la pappa abituale. Non somministriamo farmaci.</i></p>
        </div>
    </div>

</div>

<nav id="main-nav" class="hidden">
    <div onclick="showSection('home')" id="nav-home" class="active"><i class="fa-solid fa-home"></i>Home</div>
    <div onclick="showSection('metodo')" id="nav-metodo"><i class="fa-solid fa-info-circle"></i>Chi Siamo</div>
</nav>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbEVEiieOEFhU6-fVYtVMYYyJ9_l5HtDkDUu66Fzp13R42N15ANupGPgUxFbtJTVKLY/exec';

    function registra() {
        const d = {
            nome: document.getElementById('reg-nome').value,
            cane: document.getElementById('reg-cane').value,
            razza: document.getElementById('reg-razza').value,
            sesso: document.getElementById('reg-sesso').value,
            sterilizzato: document.getElementById('reg-st').value,
            note: document.getElementById('reg-note').value
        };
        if(!d.nome || !d.cane) { alert("Inserisci i dati!"); return; }
        localStorage.setItem('user_familydog_final', JSON.stringify(d));
        fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(d) });
        setTimeout(renderHome, 500);
    }

    function renderHome() {
        const user = JSON.parse(localStorage.getItem('user_familydog_final'));
        if(user) {
            document.getElementById('section-login').classList.add('hidden');
            document.getElementById('section-home').classList.remove('hidden');
            document.getElementById('main-nav').classList.remove('hidden');
            document.getElementById('dati-cane-box').innerHTML = `<b>Proprietario:</b> ${user.nome}<br><b>Cane:</b> ${user.cane} (${user.razza})`;
            recuperaStatus(user.nome);
        }
    }

    function recuperaStatus(n) {
        fetch(scriptURL + '?nome=' + encodeURIComponent(n))
        .then(r => r.json())
        .then(data => {
            document.getElementById('status-messaggio').innerText = data.status || "Nessun appuntamento attivo. Contattaci su WhatsApp!";
        })
        .catch(() => { document.getElementById('status-messaggio').innerText = "Benvenuti!"; });
    }

    function showSection(s) {
        document.getElementById('section-home').classList.add('hidden');
        document.getElementById('section-metodo').classList.add('hidden');
        document.getElementById('nav-home').classList.remove('active');
        document.getElementById('nav-metodo').classList.remove('active');
        document.getElementById('section-' + s).classList.remove('hidden');
        document.getElementById('nav-' + s).classList.add('active');
    }

    function richiediIncontro() {
        const u = JSON.parse(localStorage.getItem('user_familydog_final'));
        const m = `Ciao Davide e Maria! Sono ${u.nome}, vorrei info per ${u.cane}. Ho letto di voi e Giorgia, ci piacerebbe conoscervi!`;
        window.open(`https://wa.me/393273187212?text=${encodeURIComponent(m)}`, '_blank');
    }
    window.onload = renderHome;
</script>
</body>
</html>
